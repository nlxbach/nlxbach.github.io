<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Phần 4 Thao tác cơ bản với tập tin bản đồ | Phân tích dữ liệu sinh thái học cơ bản với R</title>
  <meta name="description" content="Tài liệu này giới thiệu một số phân tích dữ liệu sinh thái học cơ bản với phần mềm R." />
  <meta name="generator" content="bookdown 0.42 and GitBook 2.6.7" />

  <meta property="og:title" content="Phần 4 Thao tác cơ bản với tập tin bản đồ | Phân tích dữ liệu sinh thái học cơ bản với R" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tài liệu này giới thiệu một số phân tích dữ liệu sinh thái học cơ bản với phần mềm R." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Phần 4 Thao tác cơ bản với tập tin bản đồ | Phân tích dữ liệu sinh thái học cơ bản với R" />
  
  <meta name="twitter:description" content="Tài liệu này giới thiệu một số phân tích dữ liệu sinh thái học cơ bản với phần mềm R." />
  

<meta name="author" content="Nguyễn Lê Xuân Bách" />


<meta name="date" content="2025-03-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="danhphap.html"/>
<link rel="next" href="dogiauloai.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<link href="libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet" />
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.33/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Giới thiệu</a></li>
<li class="chapter" data-level="1" data-path="thaotaccoban.html"><a href="thaotaccoban.html"><i class="fa fa-check"></i><b>1</b> Một số thao tác cơ bản đối với dữ liệu đa dạng sinh học</a>
<ul>
<li class="chapter" data-level="1.1" data-path="thaotaccoban.html"><a href="thaotaccoban.html#sontra"><i class="fa fa-check"></i><b>1.1</b> Dữ liệu</a></li>
<li class="chapter" data-level="1.2" data-path="thaotaccoban.html"><a href="thaotaccoban.html#đọc-dữ-liệu"><i class="fa fa-check"></i><b>1.2</b> Đọc dữ liệu</a></li>
<li class="chapter" data-level="1.3" data-path="thaotaccoban.html"><a href="thaotaccoban.html#thao-tác-cơ-bản-trên-dữ-liệu"><i class="fa fa-check"></i><b>1.3</b> Thao tác cơ bản trên dữ liệu</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="thaotaccoban.html"><a href="thaotaccoban.html#xem-số-lượng-dòng-và-cột"><i class="fa fa-check"></i><b>1.3.1</b> Xem số lượng dòng và cột</a></li>
<li class="chapter" data-level="1.3.2" data-path="thaotaccoban.html"><a href="thaotaccoban.html#lọc-dữ-liệu-theo-cột"><i class="fa fa-check"></i><b>1.3.2</b> Lọc dữ liệu theo cột</a></li>
<li class="chapter" data-level="1.3.3" data-path="thaotaccoban.html"><a href="thaotaccoban.html#trích-lọc-theo-dòng-trong-bảng."><i class="fa fa-check"></i><b>1.3.3</b> Trích lọc theo dòng trong bảng.</a></li>
<li class="chapter" data-level="1.3.4" data-path="thaotaccoban.html"><a href="thaotaccoban.html#sắp-xếp-dữ-liệu"><i class="fa fa-check"></i><b>1.3.4</b> Sắp xếp dữ liệu</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="thaotaccoban.html"><a href="thaotaccoban.html#thống-kê-số-lượng"><i class="fa fa-check"></i><b>1.4</b> Thống kê số lượng</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="thaotaccoban.html"><a href="thaotaccoban.html#cách-1-với-các-lệnh-từ-gói-tidyverse"><i class="fa fa-check"></i><b>1.4.1</b> Cách 1 với các lệnh từ gói <code>Tidyverse</code></a></li>
<li class="chapter" data-level="1.4.2" data-path="thaotaccoban.html"><a href="thaotaccoban.html#cách-2-sử-dụng-gói-lệnh-bdvis"><i class="fa fa-check"></i><b>1.4.2</b> Cách 2 sử dụng gói lệnh bdvis</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="thaotaccoban.html"><a href="thaotaccoban.html#biểu-đồ"><i class="fa fa-check"></i><b>1.5</b> Biểu đồ</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="thaotaccoban.html"><a href="thaotaccoban.html#vẽ-nhanh-một-số-biểu-đồ-với-gói-bdvis"><i class="fa fa-check"></i><b>1.5.1</b> Vẽ nhanh một số biểu đồ với gói <code>bdvis</code></a></li>
<li class="chapter" data-level="1.5.2" data-path="thaotaccoban.html"><a href="thaotaccoban.html#số-lượng-ghi-nhận-với-gói-lệnh-ggplot2"><i class="fa fa-check"></i><b>1.5.2</b> Số lượng ghi nhận với gói lệnh <code>GGPLOT2</code></a></li>
<li class="chapter" data-level="1.5.3" data-path="thaotaccoban.html"><a href="thaotaccoban.html#biểu-đồ-treemap-thể-hiện-số-lượng-ghi-nhận-theo-họ."><i class="fa fa-check"></i><b>1.5.3</b> Biểu đồ treemap thể hiện số lượng ghi nhận theo họ.</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="iucn.html"><a href="iucn.html"><i class="fa fa-check"></i><b>2</b> Tra cứu cấp độ quý hiếm của loài theo IUCN</a>
<ul>
<li class="chapter" data-level="2.1" data-path="iucn.html"><a href="iucn.html#xin-cấp-mã-token-cá-nhân-từ-iucn"><i class="fa fa-check"></i><b>2.1</b> Xin cấp mã TOKEN cá nhân từ IUCN</a></li>
<li class="chapter" data-level="2.2" data-path="iucn.html"><a href="iucn.html#sử-dụng-gói-iucnredlist"><i class="fa fa-check"></i><b>2.2</b> Sử dụng gói <code>iucnredlist</code></a></li>
<li class="chapter" data-level="2.3" data-path="iucn.html"><a href="iucn.html#sử-dụng-gói-taxize"><i class="fa fa-check"></i><b>2.3</b> Sử dụng gói <code>taxize</code></a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="iucn.html"><a href="iucn.html#tra-cứu-cho-1-loài"><i class="fa fa-check"></i><b>2.3.1</b> Tra cứu cho 1 loài</a></li>
<li class="chapter" data-level="2.3.2" data-path="iucn.html"><a href="iucn.html#tra-cứu-cho-nhiều-loài"><i class="fa fa-check"></i><b>2.3.2</b> 2.2.2 Tra cứu cho nhiều loài</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="iucn.html"><a href="iucn.html#tính-chỉ-số-red-list-index"><i class="fa fa-check"></i><b>2.4</b> Tính chỉ số Red List Index</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="danhphap.html"><a href="danhphap.html"><i class="fa fa-check"></i><b>3</b> Xử lý danh pháp</a>
<ul>
<li class="chapter" data-level="3.1" data-path="danhphap.html"><a href="danhphap.html#tách-phần-tên-khoa-học-và-tên-tác-giả"><i class="fa fa-check"></i><b>3.1</b> Tách phần tên khoa học và tên tác giả</a></li>
<li class="chapter" data-level="3.2" data-path="danhphap.html"><a href="danhphap.html#kiểm-tra-lỗi-chính-tả-tình-trạng-danh-pháp"><i class="fa fa-check"></i><b>3.2</b> Kiểm tra lỗi chính tả, tình trạng danh pháp</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="danhphap.html"><a href="danhphap.html#nhóm-thực-vật"><i class="fa fa-check"></i><b>3.2.1</b> Nhóm Thực vật</a></li>
<li class="chapter" data-level="3.2.2" data-path="danhphap.html"><a href="danhphap.html#ví-dụ-với-gói-lệnh-rwcvp"><i class="fa fa-check"></i><b>3.2.2</b> Ví dụ với gói lệnh <code>rWCVP</code></a></li>
<li class="chapter" data-level="3.2.3" data-path="danhphap.html"><a href="danhphap.html#danh-pháp-động-vật"><i class="fa fa-check"></i><b>3.2.3</b> Danh pháp động vật</a></li>
<li class="chapter" data-level="3.2.4" data-path="danhphap.html"><a href="danhphap.html#tìm-các-cấp-phân-loại-từ-tên-loài"><i class="fa fa-check"></i><b>3.2.4</b> Tìm các cấp phân loại từ tên loài</a></li>
<li class="chapter" data-level="3.2.5" data-path="danhphap.html"><a href="danhphap.html#xem-danh-sách-các-tên-đồng-danh-của-một-loài-với-bộ-dữ-liệu-eol"><i class="fa fa-check"></i><b>3.2.5</b> Xem danh sách các tên đồng danh của một loài với bộ dữ liệu EOL</a></li>
<li class="chapter" data-level="3.2.6" data-path="danhphap.html"><a href="danhphap.html#xem-danh-sách-tất-cả-các-taxa-con-của-một-taxon"><i class="fa fa-check"></i><b>3.2.6</b> Xem danh sách tất cả các taxa con của một taxon</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="bandocoban.html"><a href="bandocoban.html"><i class="fa fa-check"></i><b>4</b> Thao tác cơ bản với tập tin bản đồ</a>
<ul>
<li class="chapter" data-level="4.1" data-path="bandocoban.html"><a href="bandocoban.html#tập-tin-vector"><i class="fa fa-check"></i><b>4.1</b> Tập tin vector</a></li>
<li class="chapter" data-level="4.2" data-path="bandocoban.html"><a href="bandocoban.html#tập-tin-dạng-raster"><i class="fa fa-check"></i><b>4.2</b> Tập tin dạng raster</a></li>
<li class="chapter" data-level="4.3" data-path="bandocoban.html"><a href="bandocoban.html#biên-tập-bản-đồ-với-gói-lệnh-ggplot-và-ggspatial"><i class="fa fa-check"></i><b>4.3</b> Biên tập bản đồ với gói lệnh <code>ggplot</code> và <code>ggspatial</code></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="dogiauloai.html"><a href="dogiauloai.html"><i class="fa fa-check"></i><b>5</b> Tạo sơ đồ độ giàu loài ở khu vực khảo sát</a>
<ul>
<li class="chapter" data-level="5.1" data-path="dogiauloai.html"><a href="dogiauloai.html#tạo-sơ-đồ-vị-trí-ghi-nhận-từ-dữ-liệu-sơn-trà"><i class="fa fa-check"></i><b>5.1</b> Tạo sơ đồ vị trí ghi nhận từ dữ liệu Sơn Trà</a></li>
<li class="chapter" data-level="5.2" data-path="dogiauloai.html"><a href="dogiauloai.html#tạo-sơ-đồ-độ-giàu-loài"><i class="fa fa-check"></i><b>5.2</b> Tạo sơ đồ độ giàu loài</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="dogiauloai.html"><a href="dogiauloai.html#tạo-lưới-có-kích-thước-1km-với-lệnh-st_make_grid."><i class="fa fa-check"></i><b>5.2.1</b> Tạo lưới có kích thước 1km với lệnh <code>st_make_grid</code>.</a></li>
<li class="chapter" data-level="5.2.2" data-path="dogiauloai.html"><a href="dogiauloai.html#đếm-số-lượng-loài-ghi-nhận-trong-từng-ô-lưới."><i class="fa fa-check"></i><b>5.2.2</b> Đếm số lượng loài ghi nhận trong từng ô lưới.</a></li>
<li class="chapter" data-level="5.2.3" data-path="dogiauloai.html"><a href="dogiauloai.html#trình-bày-sơ-đồ-hoàn-chỉnh"><i class="fa fa-check"></i><b>5.2.3</b> Trình bày sơ đồ hoàn chỉnh</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="gbif.html"><a href="gbif.html"><i class="fa fa-check"></i><b>6</b> Tải ghi nhận loài từ dữ liệu GBIF</a>
<ul>
<li class="chapter" data-level="6.1" data-path="gbif.html"><a href="gbif.html#tải-ghi-nhận"><i class="fa fa-check"></i><b>6.1</b> Tải ghi nhận</a></li>
<li class="chapter" data-level="6.2" data-path="gbif.html"><a href="gbif.html#tạo-sơ-đồ-vị-trí-ghi-nhận"><i class="fa fa-check"></i><b>6.2</b> Tạo sơ đồ vị trí ghi nhận</a></li>
<li class="chapter" data-level="6.3" data-path="gbif.html"><a href="gbif.html#xuất-dữ-liệu-sang-excel"><i class="fa fa-check"></i><b>6.3</b> Xuất dữ liệu sang Excel</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="maxent.html"><a href="maxent.html"><i class="fa fa-check"></i><b>7</b> Dự đoán vùng phân bố loài</a>
<ul>
<li class="chapter" data-level="7.1" data-path="maxent.html"><a href="maxent.html#lấy-dữ-liệu-ghi-nhận-loài-gõ-đỏ-afzelia-xylocarpa-từ-gbif"><i class="fa fa-check"></i><b>7.1</b> Lấy dữ liệu ghi nhận loài Gõ đỏ (<em>Afzelia xylocarpa</em>) từ GBIF</a></li>
<li class="chapter" data-level="7.2" data-path="maxent.html"><a href="maxent.html#xem-sơ-đồ-phân-bố-các-ghi-nhận"><i class="fa fa-check"></i><b>7.2</b> Xem sơ đồ phân bố các ghi nhận</a></li>
<li class="chapter" data-level="7.3" data-path="maxent.html"><a href="maxent.html#chạy-mô-phỏng-maxent"><i class="fa fa-check"></i><b>7.3</b> Chạy mô phỏng Maxent</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="bioindex.html"><a href="bioindex.html"><i class="fa fa-check"></i><b>8</b> Tính chỉ số đa dạng sinh học và loài quan trọng trong ô định vị</a>
<ul>
<li class="chapter" data-level="8.1" data-path="bioindex.html"><a href="bioindex.html#tạo-dữ-liệu-giả-lập"><i class="fa fa-check"></i><b>8.1</b> Tạo dữ liệu giả lập</a></li>
<li class="chapter" data-level="8.2" data-path="bioindex.html"><a href="bioindex.html#phân-tích"><i class="fa fa-check"></i><b>8.2</b> Phân tích</a></li>
<li class="chapter" data-level="8.3" data-path="bioindex.html"><a href="bioindex.html#chỉ-số-đa-dạng-sinh-học"><i class="fa fa-check"></i><b>8.3</b> Chỉ số đa dạng sinh học</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="bioindex.html"><a href="bioindex.html#tính-chỉ-số-ivi"><i class="fa fa-check"></i><b>8.3.1</b> Tính chỉ số IVI</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Phân tích dữ liệu sinh thái học cơ bản với R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="bandocoban" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Phần 4</span> Thao tác cơ bản với tập tin bản đồ<a href="bandocoban.html#bandocoban" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="tập-tin-vector" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Tập tin vector<a href="bandocoban.html#tập-tin-vector" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Để xử lý các tập tin bản đồ, chúng ta sử dụng gói lệnh <code>sf</code>.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="bandocoban.html#cb97-1" tabindex="-1"></a><span class="fu">library</span>(sf)</span></code></pre></div>
<p>Tải tập tin bản đồ về địa phận tỉnh thành của Việt Nam được cung cấp từ <a href="https://data.opendevelopmentmekong.net/vi/dataset/a-phn-tnh" class="uri">https://data.opendevelopmentmekong.net/vi/dataset/a-phn-tnh</a>.
Dùng lệnh <code>st_read</code> để đọc tập tin geojson vừa tải về. Lệnh này cũng có thể đọc tập tin *.shp.
sau đó xem nhanh bản đồ với lệnh <code>plot</code></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="bandocoban.html#cb98-1" tabindex="-1"></a>vietnam <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;DATA/Vietnamdiaphantinh.geojson&quot;</span>)</span></code></pre></div>
<pre><code>## Reading layer `Vietnamdiaphantinh&#39; from data source 
##   `/Users/bachnguyen/Library/CloudStorage/OneDrive-Personal/WORKING/ECOR/DATA/Vietnamdiaphantinh.geojson&#39; 
##   using driver `GeoJSON&#39;
## Simple feature collection with 63 features and 3 fields
## Geometry type: MULTIPOLYGON
## Dimension:     XY
## Bounding box:  xmin: 102.1421 ymin: 6.953306 xmax: 116.9473 ymax: 23.3939
## Geodetic CRS:  WGS 84</code></pre>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="bandocoban.html#cb100-1" tabindex="-1"></a><span class="fu">plot</span>(vietnam<span class="sc">$</span>geometry)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-78-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Chúng ta có thể trích lọc thông tin bản đồ dựa vào bảng dữ liệu của bản đồ.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="bandocoban.html#cb101-1" tabindex="-1"></a><span class="fu">colnames</span>(vietnam)</span></code></pre></div>
<pre><code>## [1] &quot;gid&quot;      &quot;code&quot;     &quot;ten_tinh&quot; &quot;geometry&quot;</code></pre>
<p>Ví dụ lọc bản đồ Thành phố Đà Nẵng</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="bandocoban.html#cb103-1" tabindex="-1"></a>DaNang <span class="ot">&lt;-</span> vietnam <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="bandocoban.html#cb103-2" tabindex="-1"></a>  <span class="fu">filter</span>(ten_tinh <span class="sc">==</span> <span class="st">&quot;Đà Nẵng&quot;</span>)</span>
<span id="cb103-3"><a href="bandocoban.html#cb103-3" tabindex="-1"></a></span>
<span id="cb103-4"><a href="bandocoban.html#cb103-4" tabindex="-1"></a><span class="fu">plot</span>(DaNang<span class="sc">$</span>geometry)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-80-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>giới hạn phần đất liền</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="bandocoban.html#cb104-1" tabindex="-1"></a><span class="fu">plot</span>(DaNang<span class="sc">$</span>geometry, <span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">107.8</span>,<span class="fl">108.4</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">15.9</span>,<span class="fl">16.3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-81-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Lưu thành file <em>.shp hoặc </em>.geojson với lệnh <code>st_write</code></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="bandocoban.html#cb105-1" tabindex="-1"></a><span class="fu">st_write</span>(DaNang, <span class="st">&quot;DATA/DaNang.geojson&quot;</span>, <span class="at">append =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## Updating layer `DaNang&#39; to data source `DATA/DaNang.geojson&#39; using driver `GeoJSON&#39;
## Updating existing layer DaNang
## Writing 1 features with 3 fields and geometry type Multi Polygon.</code></pre>
</div>
<div id="tập-tin-dạng-raster" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Tập tin dạng raster<a href="bandocoban.html#tập-tin-dạng-raster" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Đối với dạng raster chúng ta sử dụng gói lệnh <code>terra</code> để đọc vào R</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="bandocoban.html#cb107-1" tabindex="-1"></a><span class="fu">library</span>(terra)</span></code></pre></div>
<p>Mở tập tin bản đồ địa hình Việt Nam. Các bạn có thể tải tập tin DEM từ địa chỉ sau: <a href="http://marcchoisy.free.fr/srtm90.tif" class="uri">http://marcchoisy.free.fr/srtm90.tif</a>.
Đây là bản đồ về cao độ của Việt Nam phần đất liền.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="bandocoban.html#cb108-1" tabindex="-1"></a>VNDEM <span class="ot">&lt;-</span> <span class="fu">rast</span>(<span class="st">&quot;DATA/VNsrtm90.tif&quot;</span>)</span>
<span id="cb108-2"><a href="bandocoban.html#cb108-2" tabindex="-1"></a><span class="fu">plot</span>(VNDEM)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-84-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Cắt raster DEM_VN theo ranh giới Đà Nẵng với 2 lệnh <code>crop</code> và <code>mask</code></p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="bandocoban.html#cb109-1" tabindex="-1"></a>DaNang_dem <span class="ot">&lt;-</span> <span class="fu">crop</span>(VNDEM, DaNang) <span class="sc">|&gt;</span> </span>
<span id="cb109-2"><a href="bandocoban.html#cb109-2" tabindex="-1"></a>  <span class="fu">mask</span>(DaNang)</span>
<span id="cb109-3"><a href="bandocoban.html#cb109-3" tabindex="-1"></a><span class="fu">plot</span>(DaNang_dem,<span class="at">xlim=</span><span class="fu">c</span>(<span class="fl">107.8</span>,<span class="fl">108.4</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="fl">15.9</span>,<span class="fl">16.3</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-85-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Lưu raster thành tập tin với lệnh <code>writeRaster</code> của gói <code>terra</code></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="bandocoban.html#cb110-1" tabindex="-1"></a><span class="fu">writeRaster</span>(DaNang_dem,<span class="st">&quot;DATA/DaNangDem.tif&quot;</span>, <span class="at">overwrite=</span><span class="cn">TRUE</span>)</span></code></pre></div>
</div>
<div id="biên-tập-bản-đồ-với-gói-lệnh-ggplot-và-ggspatial" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Biên tập bản đồ với gói lệnh <code>ggplot</code> và <code>ggspatial</code><a href="bandocoban.html#biên-tập-bản-đồ-với-gói-lệnh-ggplot-và-ggspatial" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="bandocoban.html#cb111-1" tabindex="-1"></a>map1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(vietnam) <span class="sc">+</span></span>
<span id="cb111-2"><a href="bandocoban.html#cb111-2" tabindex="-1"></a>         <span class="fu">geom_sf</span>(<span class="at">color=</span><span class="st">&quot;grey&quot;</span>, <span class="at">fill =</span> <span class="st">&quot;blue&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">linewidth=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb111-3"><a href="bandocoban.html#cb111-3" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span>
<span id="cb111-4"><a href="bandocoban.html#cb111-4" tabindex="-1"></a>map1</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-87-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Thêm ký hiệu hướng bắc với hàm <code>annotation_north_arrow</code> của gói <code>ggspatial</code>. Chúng ta có thể chọn vị trí đặt ký hiệu bằng cách thay đổi location với các giá trị như “tl” cho “topleft”, “tr” cho “topright”, “br” cho “bottomright” và “bl” cho “bottomleft”.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="bandocoban.html#cb112-1" tabindex="-1"></a><span class="fu">library</span>(ggspatial)</span>
<span id="cb112-2"><a href="bandocoban.html#cb112-2" tabindex="-1"></a>map1 <span class="sc">+</span> </span>
<span id="cb112-3"><a href="bandocoban.html#cb112-3" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="at">height=</span><span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>),<span class="at">width=</span><span class="fu">unit</span>(<span class="fl">0.75</span>, <span class="st">&quot;cm&quot;</span>))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-88-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Chúng ta có thể thêm thước tỷ lệ với hàm <code>annotation_scale()</code></p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="bandocoban.html#cb113-1" tabindex="-1"></a>map1 <span class="sc">+</span> </span>
<span id="cb113-2"><a href="bandocoban.html#cb113-2" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&quot;tr&quot;</span>, <span class="at">height=</span><span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">width=</span><span class="fu">unit</span>(<span class="fl">0.75</span>, <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb113-3"><a href="bandocoban.html#cb113-3" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-89-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Để vẽ lớp raster trong ggplot, chúng ta cần sử dụng lệnh <code>geom_spatraster</code> trong gói <code>tidyterra</code></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="bandocoban.html#cb114-1" tabindex="-1"></a><span class="fu">library</span>(tidyterra)</span>
<span id="cb114-2"><a href="bandocoban.html#cb114-2" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb114-3"><a href="bandocoban.html#cb114-3" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data=</span>VNDEM)<span class="sc">+</span></span>
<span id="cb114-4"><a href="bandocoban.html#cb114-4" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">&quot;Altitude&quot;</span>, <span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">na.value =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb114-5"><a href="bandocoban.html#cb114-5" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data=</span>vietnam,<span class="at">color=</span><span class="st">&quot;grey&quot;</span>, <span class="at">fill=</span><span class="cn">NA</span>, <span class="at">linewidth=</span><span class="fl">0.02</span> )<span class="sc">+</span></span>
<span id="cb114-6"><a href="bandocoban.html#cb114-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-90-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Một tí màu mè</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="bandocoban.html#cb115-1" tabindex="-1"></a><span class="fu">library</span>(rnaturalearth)</span>
<span id="cb115-2"><a href="bandocoban.html#cb115-2" tabindex="-1"></a><span class="co">#world_map</span></span>
<span id="cb115-3"><a href="bandocoban.html#cb115-3" tabindex="-1"></a>world <span class="ot">&lt;-</span> <span class="fu">ne_countries</span>(<span class="at">scale =</span> <span class="st">&quot;medium&quot;</span>, <span class="at">returnclass =</span> <span class="st">&quot;sf&quot;</span>)</span>
<span id="cb115-4"><a href="bandocoban.html#cb115-4" tabindex="-1"></a>mycol <span class="ot">&lt;-</span> <span class="st">&quot;#fd8f24&quot;</span></span>
<span id="cb115-5"><a href="bandocoban.html#cb115-5" tabindex="-1"></a><span class="co">#plot</span></span>
<span id="cb115-6"><a href="bandocoban.html#cb115-6" tabindex="-1"></a><span class="fu">ggplot</span>(world) <span class="sc">+</span> </span>
<span id="cb115-7"><a href="bandocoban.html#cb115-7" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">color =</span> mycol) <span class="sc">+</span></span>
<span id="cb115-8"><a href="bandocoban.html#cb115-8" tabindex="-1"></a>  <span class="fu">geom_spatraster</span>(<span class="at">data=</span>VNDEM) <span class="sc">+</span></span>
<span id="cb115-9"><a href="bandocoban.html#cb115-9" tabindex="-1"></a>  <span class="fu">scale_fill_viridis_c</span>(<span class="at">name =</span> <span class="st">&quot;Altitude&quot;</span>, <span class="at">option =</span> <span class="st">&quot;viridis&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>, <span class="at">na.value =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb115-10"><a href="bandocoban.html#cb115-10" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> vietnam, <span class="at">fill =</span> <span class="cn">NA</span>, <span class="at">linewidth=</span><span class="fl">0.05</span>) <span class="sc">+</span></span>
<span id="cb115-11"><a href="bandocoban.html#cb115-11" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">100</span>,<span class="dv">118</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">24</span>)) <span class="sc">+</span></span>
<span id="cb115-12"><a href="bandocoban.html#cb115-12" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">114</span>,<span class="dv">4</span>)) <span class="sc">+</span></span>
<span id="cb115-13"><a href="bandocoban.html#cb115-13" tabindex="-1"></a>  <span class="fu">annotation_north_arrow</span>(<span class="at">location =</span> <span class="st">&#39;tr&#39;</span>, </span>
<span id="cb115-14"><a href="bandocoban.html#cb115-14" tabindex="-1"></a>                         <span class="at">height =</span> <span class="fu">unit</span>(<span class="dv">1</span>,<span class="st">&quot;cm&quot;</span>), <span class="at">width =</span> <span class="fu">unit</span>(<span class="fl">0.75</span>, <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb115-15"><a href="bandocoban.html#cb115-15" tabindex="-1"></a>                         <span class="at">style =</span> north_arrow_fancy_orienteering) <span class="sc">+</span></span>
<span id="cb115-16"><a href="bandocoban.html#cb115-16" tabindex="-1"></a>  <span class="fu">annotation_scale</span>(<span class="at">location =</span> <span class="st">&quot;bl&quot;</span>, <span class="at">width_hint =</span> <span class="fl">0.2</span>, <span class="at">height =</span> <span class="fu">unit</span>(<span class="fl">0.1</span>,<span class="st">&quot;cm&quot;</span>),</span>
<span id="cb115-17"><a href="bandocoban.html#cb115-17" tabindex="-1"></a>                   <span class="at">bar_cols =</span> <span class="fu">c</span>(mycol, <span class="st">&quot;white&quot;</span>), <span class="at">text_cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb115-18"><a href="bandocoban.html#cb115-18" tabindex="-1"></a>                   <span class="at">line_col =</span> mycol, <span class="at">text_col =</span> mycol,</span>
<span id="cb115-19"><a href="bandocoban.html#cb115-19" tabindex="-1"></a>                   <span class="at">pad_x =</span> <span class="fu">unit</span>(<span class="dv">1</span>, <span class="st">&quot;cm&quot;</span>), <span class="at">pad_y =</span> <span class="fu">unit</span>(<span class="fl">0.2</span>, <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb115-20"><a href="bandocoban.html#cb115-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb115-21"><a href="bandocoban.html#cb115-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_line</span>(<span class="at">size =</span> <span class="fl">0.1</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>)) <span class="sc">+</span></span>
<span id="cb115-22"><a href="bandocoban.html#cb115-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Longitude&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Latitude&quot;</span>, <span class="at">title =</span> <span class="st">&quot;Việt Nam&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-91-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Đổi đơn vị sang UTM zone 49 mã “32649” với thông số datum trong lệnh <code>coord_sf</code></p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="bandocoban.html#cb116-1" tabindex="-1"></a><span class="fu">ggplot</span>() <span class="sc">+</span></span>
<span id="cb116-2"><a href="bandocoban.html#cb116-2" tabindex="-1"></a>  <span class="fu">geom_sf</span>(<span class="at">data =</span> DaNang, <span class="at">fill =</span> <span class="st">&quot;grey&quot;</span>) <span class="sc">+</span></span>
<span id="cb116-3"><a href="bandocoban.html#cb116-3" tabindex="-1"></a>  <span class="fu">coord_sf</span>(<span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">107.8</span>,<span class="fl">108.4</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">15.9</span>,<span class="fl">16.3</span>), <span class="at">expand =</span> <span class="cn">FALSE</span>, <span class="at">datum =</span> <span class="dv">32649</span>) <span class="sc">+</span></span>
<span id="cb116-4"><a href="bandocoban.html#cb116-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-92-1.png" width="672" style="display: block; margin: auto;" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="danhphap.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="dogiauloai.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": true,
    "twitter": true,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": null,
    "text": null
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": null,
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
